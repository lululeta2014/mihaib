-- fresh install


Debian Graphics [
If the screen is garbled after a fresh install (no text or graphical mode):
– boot into Rescue Mode with the install disc
– open a root shell with the partition mounted as ‘/’
# apt-get install firmware-linux-nonfree
]


Debian Unmanaged Wired Network [
https://wiki.debian.org/NetworkManager
Set managed=true in /etc/NetworkManager/NetworkManager.conf
]


Debian multiarch [
# dpkg --add-architecture i386
]


[Debian] Graphics driver [
http://wiki.debian.org/ATIProprietary

This causes problems. Do it in a separate OS install.
http://wiki.debian.org/NvidiaGraphicsDrivers
? nvidia-detect
run nvidia-detect to see what driver version to install.
On Castor: nvidia-legacy-304xx-kernel-dkms
https://wiki.debian.org/NvidiaGraphicsDrivers#configure
mkdir /etc/X11/xorg.conf.d
echo -e 'Section "Device"\n\tIdentifier "My GPU"\n\tDriver "nvidia"\nEndSection' > /etc/X11/xorg.conf.d/20-nvidia.conf
]


ATI Graphics [
If you can't get proprietary drivers to work and the fan is loud:
http://www.x.org/wiki/RadeonFeature#KMS_Power_Management_Options

The ATI driver prints a message during boot about this package; without it
there is no /sys/class/drm/card0/ dir.
@debian-hermes@ firmware-linux-nonfree

# update-rc.d mihaib-radeon-power defaults      # To use it
# update-rc.d -f mihaib-radeon-power remove     # To stop using it

-------- /etc/init.d/mihaib-radeon-power --------
#! /usr/bin/env bash

### BEGIN INIT INFO
# Provides:		mihaib-radeon-power
# Required-Start:	$all
# Required-Stop:	$all
# Default-Start:	2 3 4 5
# Default-Stop:		0 1 6
# Short-Description:	Set mihaib-radeon-power options
# Description:		Enable mihaib-radeon-power options
### END INIT INFO

case "$1" in
	start)
		# Method 1
		#echo dynpm >/sys/class/drm/card0/device/power_method

		# Method 2
		echo profile >/sys/class/drm/card0/device/power_method
		echo low >/sys/class/drm/card0/device/power_profile
		;;
	stop)
		echo "Stop mihaib-radeon-power (no-op)"
		;;
	*)
		echo "Usage: /etc/init.d/mihaib-radeon-power {start|stop}"
		;;
esac
-------- /etc/init.d/mihaib-radeon-power --------
]


Disable Guest Session [
# vim /etc/lightdm/lightdm.conf
allow-guest=false
]


Fix Ubuntu (11.10 onwards) umask [
sed -i -e 's/^USERGROUPS_ENAB yes$/#USERGROUPS_ENAB yes/' /etc/login.defs
Note: userdel won't remove a user's group (if it becomes empty) by default now.
]


Automatic Login [
Gnome3
# vim /etc/gdm3/daemon.conf
AutomaticLoginEnable = true
AutomaticLogin = <username>

Lightdm
# vim /etc/lightdm/lightdm.conf
autologin-user=<youruser>
autologin-user-timeout=0
autologin-session=<thesession>
user-sesion=<defaultsession>
]


GRUB [
sed -i \
	-e 's/^GRUB_TIMEOUT=.*$/GRUB_TIMEOUT=2/' \
	-e 's/^#GRUB_DISABLE_RECOVERY="true"$/GRUB_DISABLE_RECOVERY="true"/' \
	/etc/default/grub
cd /etc/grub.d/
chmod -x 20_memtest86+ 30_os-prober
update-grub			# /boot/grub/grub.cfg is regenerated

https://wiki.ubuntu.com/Grub2
]


Change first day of the week [
sed -i \
	-e 's/^first_weekday\t[0-9]$/first_weekday\t2/' \
	/usr/share/i18n/locales/en_US
locale-gen	# regenerate the locale
]


Change startup / shutdown splash screen [
# sudo update-alternatives --config default.plymouth
# sudo update-initramfs -u
]


[Debian] disable apt-get fetching translations [
cat >/etc/apt/apt.conf.d/99translations <<<'Acquire::Languages "none";'
rm -f /var/lib/apt/lists/*Translation*
]


Wireless [
Hermes Ubuntu 10.10: STA driver not B43

Debian: http://wiki.debian.org/WiFi
@debian-jessie-hermes@ firmware-b43-installer
@debian-wheezy-hermes@ firmware-b43-lpphy-installer
]


[Debian] Ugly buzzing sound [
modprobe -r pcspkr
To make it permanent:
echo "blacklist pcspkr" > /etc/modprobe.d/nobeep.conf
or:
System → Preferences → Sound → Preferences → choose PC Beep to be displayed
Mute PC Beep.
or:
$ alsamixer
select sound card -> navigate to Beep -> press ‘M’ to mute
(setting its volume to 0 isn't enough).
]


[Debian] Touchpad tap to click [
GNOME has settings for this, but using the steps below should enable it for
all users in all desktop environments:
temporary enable: synclient TapButton1=1

The system file is in /usr/share/X11/xorg.conf.d/50-synaptics.conf and says
to copy (and rename) it into /etc/X11/xorg.conf.d instead of editing in place.

/usr/share/doc/xorg/howto/configure-input.html
-------- /etc/X11/xorg.conf.d/42-synaptics.conf --------
Section "InputClass"
    Identifier "touchpad tweaked catchall"
    MatchIsTouchpad "on"
    Driver "synaptics"
    Option "TapButton1" "1"
    Option "HorizEdgeScroll" "1"
EndSection
-------- /etc/X11/xorg.conf.d/42-synaptics.conf --------
]


Remove panel messaging icons [
^ indicator-messages indicator-me
]


Ask for password when mounting internal media [
^ policykit-desktop-privileges
]


[Debian] list changes at apt-get dist-upgrade [
^ apt-listchanges
]

[Ubuntu] disable crash reporter apport [
sudo sed -i /etc/default/apport -e s/^enabled=1$/enabled=0/
]


-- programs


Vim [
@headless@ vim bvi
@gnome-or-xfce@ vim-gnome

$ cp /usr/share/vim/vimrc ~/.vimrc

set pastetoggle=<F2>
http://vim.wikia.com/wiki/VimTip906

# Java, Python indentation
# (system files are in /usr/share/vim/vimcurrent/syntax/python.vim)
mkdir -p ~/.vim/syntax
echo ":set tabstop=4 softtabstop=4 shiftwidth=4 noexpandtab" \
	>~/.vim/syntax/java.vim
echo ":set tabstop=8 softtabstop=4 shiftwidth=4 expandtab" \
	>~/.vim/syntax/python.vim

# Add new extension to known language. Add the following line to ~/.vimrc:
au BufNewFile,BufRead *.see set filetype=cpp

# right margin. Add this to .vimrc:
http://en.wikibooks.org/wiki/Learning_the_vi_editor/Vim/Enhancing_Vim
:highlight rightMargin ctermbg=red
:highlight rightMargin ctermfg=yellow
:highlight rightMargin guibg=red
:highlight rightMargin guifg=yellow
:match rightMargin /.\%>80v/
]


Synaptic [
@ synaptic
]


cmdline tools, gcc, make [
@headless@ build-essential htop tree curl
]


Python3 [
@headless@ python3
@ python3-tk python3-keyring
? idle3
]


Meld [
@ meld
]


Java [
? sun-java6-jdk sun-java6-plugin sun-java6-fonts

# update-java-alternatives -l
# update-java-alternatives -s chosen_alternative

Run .jar files from nautilus without setting executable bit:
# vim /usr/share/applications/sun-java6-java.desktop
replace:
Exec=cautious-launcher %f /path/to/java -jar
with:
Exec=/path/to/java -jar

Manual install:
Add /path/to/jdk/bin to PATH.

The plugin path depends on 32/64 & JRE/JDK. Refer to install instructions, eg:
http://download.oracle.com/javase/7/docs/webnotes/install/linux/linux-plugin-install.html

$ mkdir -p ~/.mozilla/plugins
$ ln -s /path/to/jdk-1.7/jre/lib/amd64/libnpjp2.so ~/.mozilla/plugins
Should work in both Firefox and Chromium. Else try ~/chromium-browser/plugins.

Opera: add this line under [Paths] in /path/to/opera/profile/pluginpath.ini:
~/.mozilla/plugins=1

Ant: add /path/to/ant/bin to PATH.
]


SCM [
@headless@ git git-svn git-cvs mercurial subversion cvs
@ git-gui gitk
?gnome? gitg
? git-doc

git config --global color.ui auto
git config --global user.name "Your Name"
git config --global user.email "you@example.com"

Git cvsimport:
git cvsimport -p -b,HEAD -r origin -C mymodule -d :ext:user@host:/cvs/external mymodule
]


Git fork [
Downstream repo:
git remote add upstream «url»
git fetch upstream

Work in a ‘backports’ branch.

Upstream repo:
git remote add -t backports downstream «url»
git fetch downstream
]


CheckGmail [
@ checkgmail
]

CheckGmail Gnome Keyring [
@ libextutils-pkgconfig-perl libgnome-keyring-dev
@ libfile-sharedir-perl libpod-readme-perl libtest-pod-coverage-perl
]


Vlc [
@ vlc
? mozilla-plugin-vlc
]


Flash [
@ubuntu@ flashplugin-installer
@debian@ flashplugin-nonfree
? ttf-xfree86-nonfree
]


Archive formats [
@ unrar unace-nonfree p7zip p7zip-full
@headless@ zip
? xz-utils
]


chm [
@gnome-or-xfce@ xchm
@kde@ kchmviewer
]


Eclipse [
Window→Preferences→..→Installed JREs→select the jre→edit→select rt.jar→javadoc location→file:///path/to/jdk-docs/api
]


LaTeX (TexLive) [
@ perl-tk
Add /path/to/texlive/2011/bin/x86_64-linux to PATH.
]


TextTest [
? tkdiff

-------- ~/.texttest/config --------
view_program:gedit
diff_program:meld
-------- ~/.texttest/config --------


in .bashrc: alias texttest='path/to/texttest/source/bin/texttest.py'

To use relative paths in config.<app>:
# Full path to the System Under Test
executable:$TEXTTEST_ROOT/hello.py

To copy/link files/dirs to the sandbox, add to application's config.<app>:
link_test_path:file.txt
copy_test_path:file.txt
copy_test_path:dir
TextTest searches in the test, then the parent test suite, up to the root.
]


Haskell [
? ghc6
]


Wine [
@ wine
@debian@ lib32nss-mdns
]


uTorrent [
-------- run-utorrent.sh --------
#!/bin/bash

# Absolute path to this script
SCRIPT=`readlink -f "$0"`

# Absolute path this script is in
DIR=`dirname "$SCRIPT"`

export WINEPREFIX="$DIR/.wine"
wine "$DIR/utorrent.exe" /NOINSTALL
-------- run-utorrent.sh --------

-------- utorrent-server.sh --------
#!/bin/bash

# Absolute path to this script
SCRIPT=`readlink -f "$0"`

# Absolute path this script is in
DIR=`dirname "$SCRIPT"`

cd $DIR

# point a .desktop launcher to this script.

# 1) alltray version (not working in gnome3):
# launcher does:
# alltray utorrent-server.sh -i icon.png
# this file does:
#gnome-terminal --disable-factory -x ./utserver &

# 2) kdocker version:
# launcher does:
# kdocker -i icon.png gnome-terminal --disable-factory -x utorrent-server.sh
# this file does:
./utserver
-------- utorrent-server.sh --------
]


Gnome Open Terminal (right-click) [
@gnome@ nautilus-open-terminal
]


gedit show spaces [
@gnome-or-xfce@ gedit-plugins
]


sensors [
@debian-gnome@ sensors-applet
? lm-sensors hddtemp
# sensors-detect
]


GIMP [
@ gimp
]


Inkscape [
@ inkscape
]


ImageMagick [
@ imagemagick
]


Adobe Reader [
@ libgtk2.0-0:i386
]


mp3info [
@headless@ mp3info
]


Kid3 [
@ kid3
]


battery charge [
@laptop@ acpi
]


GParted [
@ gparted
]


Skype [
?debian-wheezy? ia32-libs-gtk
?debian? libqt4-webkit:i386 libxv1:i386 libxss1:i386
?ubuntu12.10? ia32-libs libtiff4:i386
]


XChat IRC [
? xchat

~/.xchat2/xchat.conf

Selecting ‘minimize to tray’ and ‘don't ask next time’ when closing the window
changes ‘gui_tray_flags’ from 0 to 1

Selecting ‘quit’ and ‘don't ask next time’ on tray right-click->quit
changes ‘gui_quit_dialog’ from 1 to 0
]


Thunderbird [
?ubuntu? thunderbird
?debian? icedove
?ubuntu-Gnome? thunderbird-gnome-support
? ttf-lyx
]


WineIcons (extract icons from exe files) [
http://wineicons.sourceforge.net/
]


SoundConverter [
@ soundconverter
@ gstreamer0.10-plugins-ugly gstreamer0.10-ffmpeg
]


Jack [
@jack flac vorbis-tools
]


Rhythmbox [
@ rhythmbox
]


Chromium [
@ubuntu@ chromium-browser
@debian@ chromium
]


Conky [
@ conky
]


numlockx [
@ numlockx
]


sqlite [
@headless@ sqlite3
]


money-trail [
@debian@ libsqlite3-dev
]


rl (randomize-lines) [
@headless@ randomize-lines
]


gconf-editor [
@gconf-editor
]


DOT graphs (graphviz) [
@headless@ graphviz
]


minimize to tray [
@ alltray kdocker
]


geany [
@ geany
]


gnome [
@gnome@ gnome gnome-tweak-tool
]


notify-osd (disable persistent Gnome3 notification stack) [
@gnome@ notify-osd
]


Audio [
@audio@ ardour timidity wildmidi alsaplayer-jack
]


AdblockPlus [
@debian@ xul-ext-adblock-plus
]


PEP8 linter [
https://github.com/jcrocholl/pep8.git
To always disable specific errors (e.g. ‘E501 line too long’):
alias pep8='pep8.py --ignore E501'
]


nginx [
? libpcre3-dev libssl-dev
./configure --prefix=/some/path --with-http_ssl_module
make
make install
]


-- sysadmin


Remove old kernels [
$ sudo apt-get purge linux-image-2.<version>-generic linux-headers-2.<version>
]


GRUB2 Dedicated Partition [
If the partition is /dev/sdc1 and it's mounted in /mnt/path:
mkdir /mnt/path/boot
grub-install --force --boot-directory=/mnt/path/boot /dev/sdc1

You can generate grub.cfg with: grub-mkconfig -o /mnt/path/boot/grub/grub.cfg

https://help.ubuntu.com/community/Grub2/ISOBoot
https://help.ubuntu.com/community/Grub2/ISOBoot/Examples
To boot specific menu entries from a bootable ISO disc (if it supports this)
replace the kernel/initrd/params it uses in the examples below.
GParted: /isolinux/isolinux.cfg
Ubuntu:  /isolinux/isolinux.cfg → menu.cfg → txt.cfg
You must add an extra parameter, the path to the ISO file:
GParted: findiso=$isofile
Ubuntu:  iso-scan/filename=$isofile

-------- grub.cfg for removable drive --------
set menu_color_normal=light-blue/black
set menu_color_highlight=white/blue

set timeout=-1

insmod chain

# The USB drive shows up as (hd0), the HDD as (hd1):
# this is how we'll refer to them in this file.
# drivemap swaps them for the next bootloader we chainload to, not for us.
drivemap -s (hd0) (hd1)

menuentry "Boot from HDD" {
set root=(hd1)
chainloader +1
}

menuentry "Chainload sda6" {
set root=(hd1,6)
chainloader +1
}

menuentry "Multiboot sda6" {
set root=(hd1,6)
multiboot /boot/grub/core.img
}

menuentry "ISO Ubuntu 13.10 Live" {
set isofile="/isos/ubuntu-13.10-desktop-amd64.iso"
loopback loop (hd0,2)$isofile
# commenting quiet&splash options below
linux (loop)/casper/vmlinuz.efi iso-scan/filename=$isofile file=/cdrom/preseed/ubuntu.seed boot=casper #quiet splash
initrd (loop)/casper/initrd.lz
}

menuentry "ISO Ubuntu 13.10 Install" {
set isofile="/isos/ubuntu-13.10-desktop-amd64.iso"
loopback loop (hd0,2)$isofile
# commenting quiet&splash options below
linux (loop)/casper/vmlinuz.efi iso-scan/filename=$isofile file=/cdrom/preseed/ubuntu.seed boot=casper only-ubiquity #quiet splash
initrd (loop)/casper/initrd.lz
}

menuentry "ISO GParted 0.17.0-4 Live (Default settings)" {
set isofile="/isos/gparted-live-0.17.0-4-amd64.iso"
loopback loop (hd0,2)$isofile
linux (loop)/live/vmlinuz findiso=$isofile boot=live username=user config quiet noswap  ip=  nosplash
initrd (loop)/live/initrd.img
}
-------- grub.cfg for removable drive --------

-------- grub.cfg for dedicated partition --------
if [ -s $prefix/grubenv ]; then
  set have_grubenv=true
  load_env
fi
set default="${saved_entry}"
if [ "${prev_saved_entry}" ]; then
  set saved_entry="${prev_saved_entry}"
  save_env saved_entry
  set prev_saved_entry=
  save_env prev_saved_entry
  set boot_once=true
fi

function savedefault {
  if [ -z "${boot_once}" ]; then
    saved_entry="${chosen}"
    save_env saved_entry
  fi
}

set menu_color_normal=light-gray/black
set menu_color_highlight=yellow/blue

set timeout=5

insmod chain

menuentry "Chainload sda5" {
set root=(hd0,5)
savedefault
chainloader +1
}

menuentry "Multiboot sda5" {
set root=(hd0,5)
savedefault
multiboot /boot/grub/core.img
}
-------- grub.cfg for dedicated partition --------
]


GRUB Legacy Dedicated Partition [
Boot with Ubuntu 9.04 LiveCD.

If the partition is /dev/sdc1 and it's mounted in /mnt/path:
# grub-install --no-floppy --root-directory=/mnt/path /dev/sdc1

To generate menu.lst:
# ln -s /mnt/path/boot/grub /boot/grub
# update-grub
]


Disk Encryption (Encrypt entire partition) [
Overview:
========
Shared partitions (/mnt/my-data, swap) are encrypted only once (e.g. when you
install the first OS).
Each OS has its own /boot and / (root) partitions, and /boot is not encrypted.
When you install an OS, it knows only about its own /boot and / (root) and
nothing else (not even swap, or you'll have to type the encryption password
multiple times at each boot).
Afterwards, boot into the new OS and tell it about the shared encrypted
partitions (/mnt/my-data, swap).

OS Install:
==========
Create 2 partitions:
― /boot (e.g. 200 MB or more, not just 100 MB, because this isn't a ‘dummy’
/boot with only the 10MB for grub, but each kernel version's initrd&co. files
need >20MB)
― / (root)

If there's an old, leftover unencrypted swap partition, mark it as ‘not used’
(because it's automatically marked as used for swap). Later on the partitioner
won't let you proceed if you have encrypted volumes & decrypted swap.
When you finish the partitioning step confirm you want to proceed without swap.

Ubuntu:
In the graphical partitioner, for the / (root) partition select:
Change…→physical volume for encryption
After this, a new partition will appear at the top of the list under:
/dev/mapper/sda999_crypt
Set its filesystem and mount point (/) there.

Treat the new unencrypted /boot partition normally,
from its normal place in the list.

Debian:
In the partitioner, for the / (root) partition select:
use as → physical volume for encryption
Leave all options to their defaults, but you may set ‘Erase data’ to ‘no’
to avoid waiting for a very long disk wiping.

NOTE: If this is the first time you're installing an OS on this computer,
also mark the shared partitions (/mnt/my-data, swap) the same way for
encryption. See above for ‘shared partitions are encrypted only once’.

From above the list of partitions (scroll up) select the entry:
Configure encrypted volumes
Might ask to write existing partition changes to disk, confirm it.
Select: Finish
You'll get one password dialog box for each volume you're encrypting.

Now you're back to the partitioning tool and the newly encrypted volumes are
at the top as /dev/mapper/sda999_crypt each with a partition under it.
Set the filesystem and mountpoint here.

Mounting the shared partitions and swap:
=======================================
Boot into the new system. You must type the encryption password of the / (root)
partition. If we'd have told the installer about a swap partition, we'd always
have to type the password twice (once for / (root) and once for swap, no matter
what we do).

/etc/crypttab will have this line:
sda999_crypt	UUID=…	none	luks
Add one line for each encrypted partition (or volume). To avoid typing the
password repeatedly on every boot for each volume you'll add, write the
password in a file, without a trailing newline, and use it instead of ‘none’.
But leave the existing line in crypttab unchanged (for the / (root) partition).
sda888_crypt	/dev/sda888	/home/enc-pass-file	luks
sda777_crypt	/dev/sda777	/home/enc-pass-file	luks,swap

Add these partitions to /etc/fstab:
/dev/mapper/sda888_crypt	/mnt/my-data	ext4	defaults	0	2
/dev/mapper/sda777_crypt	none	swap	sw	0	0
]


Add user [
# adduser -u UID name
Use System->Administration->Users and Groups to give/manage privileges
]


Change CPU Frequency Scaling without password [
/usr/share/polkit-1/actions/org.gnome.cpufreqselector.policy
replace
<allow_active>auth_admin_keep</allow_active>
with
<allow_active>yes</allow_active>

The Gnome panel widget won't ask for password.
]


cron [
$ crontab -e

To run command in a login shell (e.g. load your .bashrc):
bash --login -c '/path/to/program arg1 arg2'

/var/spool/cron/crontabs/`whoami`
]


File synchronization [
# With directories:
ls -AgGpR --group-directories-first --time-style="+%Y-%m-%d %H:%M:%S %z"

# Without dirs (even ‘grep -v ^d’ is safe, when we list the current ‘.’ dir):
ls -AgGR --time-style="+%Y-%m-%d %H:%M:%S %z" | grep -v ^drwxr-xr-x

alias cp='cp --preserve=timestamps,mode'
]


[Debian] startup script [
http://www.debian-administration.org/articles/28
http://wiki.debian.org/LSBInitScripts

Write executable script /etc/init.d/myscript.
To use it:
# update-rc.d myscript defaults
To stop using it:
# update-rc.d -f myscript remove

You can use ‘$all’ for Required-Start and Required-Stop below.

-------- /etc/init.d/phabricator --------
#! /usr/bin/env bash

### BEGIN INIT INFO
# Provides:		phabricator
# Required-Start:	$remote_fs $network $syslog
# Required-Stop:	$remote_fs $network $syslog
# Default-Start:	2 3 4 5
# Default-Stop:		0 1 6
# Short-Description:	Start phabricator at boot time
# Description:		Enable phabricator service
### END INIT INFO

case "$1" in
	start)
		/bin/su user -c "/programs/phb/up-phb"
		;;
	stop)
		/bin/su user -c "/programs/phb/down-phb"
		;;
	*)
		echo "Usage: /etc/init.d/phabricator {start|stop}"
		;;
esac
-------- /etc/init.d/phabricator --------
]


NTFS /etc/fstab mount options [
uid=1000,gid=1000,dmask=022,fmask=133,utf8
]


Windows DNS [
? winbind
/etc/samba/smb.conf: wins server 192.168.1.1
/etc/nsswitch.conf: add ‘wins’ to ‘hosts:...’ line
]


SSH Keep Alive [
mkdir -p ~/.ssh
echo >>~/.ssh/config 'Host *
    ServerAliveInterval 60'
]


SSH Multiple keys [
~/.ssh/config:
Host friendly-domain-name
	HostName example.com
	IdentityFile ~/.ssh/friendly-id_rsa

Use ‘friendly-domain-name’ instead of example.com in commands,
e.g. ‘github.com.mb-mihaib’.
]


NTP [
@headless@ ntpdate
]


[Debian] NetworkManager change(edit) Wired Network, e.g. DNS [
If you can't make changes to the Wired Network from NetworkManager,
comment out its line from /etc/network/interfaces:
iface eth0 inet dhcp
Restart and now NetworkManager will let you edit it.
]


-- other


[Debian] Gnome2 Remove icons from Desktop [
$ gconf-editor
apps → nautilus → desktop
uncheck the boxes
]


[Gnome2] Add applets and launchers to panel from the command line [
Existing launchers are .desktop files in ~/.gnome2/panel2.d/default/launchers/.

-------- my-launcher.desktop --------
#!/usr/bin/env xdg-open

[Desktop Entry]
Version=1.0
Type=Application
Terminal=false
Icon[en_US]=/path/to/icon.svg
Icon=/path/to/icon.svg
Name[en_US]=MyProgram
Name=MyProgram
Exec=/path/to/executable
-------- my-launcher.desktop --------

/usr/lib/gnome-panel/gnome-panel-add --launcher=/tmp/my-launcher.desktop --panel=top_panel_screen0


Existing applets are under /apps/panel/applets in gconf-editor.
/usr/lib/gnome-panel/gnome-panel-add \
	--applet=MultiLoadAppletFactory::MultiLoadApplet \
	--panel=top_panel_screen0 --position=500
Or use --right-stick instead of --position=500.
]


[Gnome] Keyboard shortcuts [
Keyboard -> Layout options -> Alt/Win-key behavior -> Super is mapped to the Win-keys
$ gconf-editor
Browse to apps/metacity/keybinding_commands
command_1	notify-send -i clock "$(date -u '+%b %-d, %H:%M GMT')"
Browse to apps/metacity/global_keybindings
run_command_1	<Mod4>c
]


[Gnome] Login screen background [
# cp /usr/share/applications/gnome-appearance-properties.desktop \
	/usr/share/gdm/autostart/LoginWindow
Log out, change background, log in
# unlink /usr/share/gdm/autostart/LoginWindow/gnome-appearance-properties.desktop
]


XFCE [
@xfce@ xfce4 xfce4-goodies xfce4-power-manager-plugins scrot parole
@ubuntu-xfce@ xubuntu-desktop
@xfce@ gtk3-engines-xfce clearlooks-phenix-theme
?xfce? xfwm4-themes

Settings are under ~/.config/xfce4/xfconf/xfce-perchannel-xml/ and can be
changed programatically with xfconf-query: xfconf-query -c <CHANNEL> -lv
]


XFCE sound / volume control [
Run gnome-sound-applet (renamed in Gnome 3 from gnome-volume-control-applet).
http://www.kirsle.net/blog/kirsle/gnome-s-impact-on-everything
]


LXDE [
@lxde@ lxde
@ubuntu-lxde@ lubuntu-desktop

http://superuser.com/questions/167259/how-can-i-add-a-lxde-shortcut-to-launch-an-application
http://openbox.org/wiki/Help:Bindings
http://openbox.org/wiki/Help:Actions

~/.config/openbox/lxde-rc.xml or lubuntu-rc.xml
$ openbox-lxde --reconfigure
]


Fonts [
@ ttf-mscorefonts-installer
? ttf-dejavu fonts-droid

Choose Monospace font (e.g. @fonts-droid changes `fc-match Monospace`):
-------- ~/.fonts.conf --------
<?xml version="1.0"?>
<!DOCTYPE fontconfig SYSTEM "fonts.dtd">
<fontconfig>
<alias>
	<family>monospace</family>
	<prefer><family>DejaVu Sans Mono</family></prefer>
</alias>
</fontconfig>
-------- ~/.fonts.conf --------

Disable antialising for specific font:
-------- ~/.fonts.conf --------
<?xml version="1.0"?>
<!DOCTYPE fontconfig SYSTEM "fonts.dtd">
<fontconfig>
  <match target="font">
    <test qual="any" name="family">
      <string>Courier New</string>
    </test>
    <edit name="antialias" mode="assign">
      <bool>false</bool>
    </edit>
  </match>
</fontconfig>
-------- ~/.fonts.conf --------
]


libnotify [
@ libnotify-bin

Icons seem to be searched under /usr/share/icons/«current-theme»/
but an absolute path can be given.
notify-send -i clock "$(date -u '+%b %-d, %H:%M GMT')"
notify-send -i /usr/share/icons/Humanity/apps/48/clock.svg "$(date -u '+%b %-d, %H:%M GMT')"
]


Sourceforge Web [
sftp://user,project@web.sourceforge.net/home/groups/p/pr/project/htdocs
sftp://user@web.sourceforge.net/home/userweb/u/us/user/htdocs
]


Browser privacy [
Firefox:

Referrer: http://kb.mozillazine.org/Network.http.sendRefererHeader
Open about:config
set network.http.sendRefererHeader to 0
(set network.http.sendSecureXSiteReferrer to false)
]


Go language (golang) [
? bison gawk
? mercurial

Clone hg repo in /path/to/go/repo

-------- /path/to/go/env-vars --------
export GOROOT=/path/to/go/repo
export GOARCH=amd64
export GOOS=linux
export GOBIN=/path/to/go/bin

export PATH=$PATH:$GOBIN
-------- /path/to/go/env-vars --------

edit .bashrc:
source /path/to/go/env-vars

Build:
$ cd src/
$ ./all.bash

Update repo with (I think):
hg pull -u -r release

$ mkdir -p ~/.vim/syntax ~/.vim/ftdetect ~/.vim/indent

Syntax and filetype detect in $GOROOT/misc/vim
$ ln -s $GOROOT/misc/vim/syntax/go.vim ~/.vim/syntax/go.vim
$ ln -s $GOROOT/misc/vim/ftdetect/gofiletype.vim ~/.vim/ftdetect/go.vim

Indentation file: http://go-lang.cat-v.org/text-editors/vim/
$ wget http://go-lang.cat-v.org/text-editors/vim/go-indent.vim -O ~/.vim/indent/go.vim

Gedit: place go.lang from http://go-lang.cat-v.org/text-editors/
in ~/.local/share/gtksourceview-2.0/language-specs/

$ mkdir -p ~/.local/share/gtksourceview-2.0/language-specs/
$ wget http://go-lang.cat-v.org/text-editors/gedit/go.lang -O ~/.local/share/gtksourceview-2.0/language-specs/go.lang
]


Thrift [
? libboost-dev flex bison

Get it from the apache website (e.g. thrift-0.2.0-incubating.tar.gz).

$ ./configure
$ make
The executable is: compiler/cpp/thrift

For Java .jars go to lib/java/
$ ant
The jars are: libthrift.jar and the ones in build/ivy/lib/
]


(Gnome2) Window Management [
? compizconfig-settings-manager compiz-fusion-plugins-extra

§ Maximize horizontally/vertically with the mouse

$ gconf-editor
apps -> metacity -> general
action_middle_click_titlebar toggle_maximize_vertically
action_right_click_titlebar toggle_maximize_horizontally

§ Maximize horizontally/vertically with the keyboard

If Visual Effects (in System → Preferences → Appearance) are set to None:
System → Preferences → Keyboard Shortcuts
Maximize window vertically/horizontally ‘toggle’ maximization state.

§ Toggle auto-hiding of panels

gconftool-2 --type bool \
	--set /apps/panel/toplevels/top_panel_screen0/auto_hide true

-------- toggle-bottom-gnome-panel.sh --------
#!/bin/bash

if [ $(gconftool-2 \
	--get /apps/panel/toplevels/bottom_panel_screen0/auto_hide) \
	== "true" ]; then
	gconftool-2 --type bool \
	--set /apps/panel/toplevels/bottom_panel_screen0/auto_hide false
else
	gconftool-2 --type bool \
	--set /apps/panel/toplevels/bottom_panel_screen0/auto_hide true
fi;
-------- toggle-bottom-gnome-panel.sh --------

§ The rest of this section applies only if Visual Effects are on

If Visual Effects are on, turn off the above from Keyboard Shortcuts
(now they maximize but don't ‘toggle’ back):
System → Preferences → CompizConfig Settings Manager
General Options → Key Bindings → Toggle Window Maximized Horizotally/Vertically

In Ubuntu 10.10 with Visual Effects → Normal (System→Preferences→Appearance),
setting Mod4+A for ‘Initiate Window Picker’ in Keyboard Shortcuts
produces the perfect behavior of showing the windows on your current desktop
on the first keystroke and the windows on all desktops on the second keystroke.

§ System → Preferences → CompizConfig Settings Manager

Window Management → Static Application Switcher → Behaviour:
set Popup Window Delay to 0

Enable: Window Management → Extra WM Actions
(logout&login to make the Toggle Fullscreen set in Keyboard Shortcuts work).

Enable: Window Management → Ring Switcher

If some shortcuts set in Keyboard Shortcuts don't work now, logout&login.
(if they still don't work set them again).
]


GDesklets [
?Gnome? gdesklets

Fix gdesklets:
# vim /usr/lib/gdesklets/utils/ErrorFormatter.py
Change line 116 from:
def _new_imp(name, globs = {}, locls = {}, fromlist = []):
to:
def _new_imp(name, globs = {}, locls = {}, fromlist = [], test = []):

Download GoodWeather 0.31 from http://gdesklets.de/?q=desklet/view/232 & unzip

mkdir -p ~/.gdesklets/Displays ~/.gdesklets/Sensors
cp -r Displays/GoodWeather ~/.gdesklets/Displays
cp -r Sensors/GoodWeather ~/.gdesklets/Sensors
~/.gdesklets/Displays/GoodWeather/Install_GoodWeather_Sensor.bin
rm ~/.gdesklets/Displays/GoodWeather/Install_GoodWeather_Sensor.bin

gdesklets shell
Choose to view 'alphabetically', add to desktop with double click.
Get your location code from www.weather.com.

Old unneeded fix:
vim ~/.gdesklets/Sensors/GoodWeather/__init__.py
WEATHER_SOURCE = "http://xoap.weather.com/weather/local/" \
                 "%(weather_code)s?cc=*&dayf=5&prod=xoap&" \
                 "par=1003832479&key=bb12936706a2d601"
replace second line with:
                 "%(weather_code)s?cc=*&dayf=5&prod=xoap&link=xoap&" \

Icon sets:
http://liquidweather.net/icons.php#iconsets
Example installation for Shiny:
copy Shiny to ~/.gdesklets/Sensors/GoodWeather
vim ~/.gdesklets/Sensors/GoodWeather/__init__.py
        configurator.add_option(_("Icons:"), "icons",
                                _("Choose an icon set"),
                                [(_("Liquid"), "liquid"),
                                 (_("UM"), "um"),
                                 (_("weather.com"), "weather.com")])
add Shiny between Liquid and UM:
                                 (_("Shiny"), "Shiny"),
complete list:
                                [(_("7even"), "7even"),
                                 (_("Aqua"), "Aqua"),
                                 (_("Babasse"), "Babasse"),
                                 (_("BBC"), "BBC"),
                                 (_("Beginnings"), "Beginnings"),
                                 (_("Bihan"), "Bihan"),
                                 (_("Crystal"), "Crystal"),
                                 (_("Epona"), "Epona"),
                                 (_("Flat"), "Flat"),
                                 (_("Flat White"), "Flat White"),
                                 (_("Glossy"), "Glossy"),
                                 (_("Grzanka"), "Grzanka"),
                                 (_("Jivesucker"), "Jivesucker"),
                                 (_("Kapsules"), "Kapsules"),
                                 (_("Liquid"), "liquid"),
                                 (_("Nova"), "Nova"),
                                 (_("Pod"), "Pod"),
                                 (_("r-weather"), "r-weather"),
                                 (_("Samurize"), "Samurize"),
                                 (_("Shiny"), "Shiny"),
                                 (_("Simple"), "Simple"),
                                 (_("Sticker"), "Sticker"),
                                 (_("UM"), "um"),
                                 (_("weather.com"), "weather.com"),
                                 (_("wireart"), "wireart")])

Add to startup applications:
-------- gdesklets-delay.sh --------
#!/bin/bash
sleep 60
gdesklets
-------- gdesklets-delay.sh --------

Fix spacing:
1) temp_range is '10 :22 ', make '10:22'
vim ~/.gdesklets/Sensors/GoodWeather/weather.py
def temp_range(..) has several slices [:-7]; make them [:-8]
2) cell width depends on day name length; shift temp
output.set("day"+str(i), «val») → '  ' + «val» + '  '
output.set("temp"+str(i), «val») → ' ' + «val»
]


NetworkManager disable wireless [
https://answers.launchpad.net/ubuntu/+source/network-manager/+question/72343

Run on session startup:
dbus-send --system --type=method_call --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.DBus.Properties.Set string:org.freedesktop.NetworkManager string:WirelessEnabled variant:boolean:false
]


LSB [
? lsb-cxx
lsb-cxx is enough for lmgrd; there is a lsb package which depends on lsb-cxx
Note: removes nullmailer
]


Apple [
To boot a specific partition, CD, USB: hold Alt during boot.

There is a boot partition, the main partition, and a recovery partition.
Disk Utility only shows the main partition. Resizing it will also move
the recovery partition, such that free space will be at the end.

Install rEFIt, reboot computer a few times (the boot menu won't show at first).
rEFIt boot order:
edit /efi/refit/refit.conf to uncomment ‘#legacyfirst’ and change timeout.

If you try to boot Linux (or just GRUB on a dedicated partition), rEFIt says:
‘No bootable device’.
Go into the rEFIt Partitioning Tool and let it update the MBR.
Since only 4 partitions fit into the MBR, it might be a good idea to have your
GRUB partition after the first 3 Apple partitions (its boot, main, recovery).

The Ubuntu 12.04.1 ISO gives a kernel panic: add the ‘noapic’ kernel option
(by editing the GRUB menu entry each time you boot either the install CD
or the new system).
Edit /etc/default/grub and add ‘noapic’ to GRUB_CMDLINE_LINUX_DEFAULT then run
update-grub.
Both Ubuntu 12.04 and Debian Wheezy need this (kernel 3.2).
Ubuntu 12.10 doesn't (kernel 3.5).
For Debian Wheezy you only have to do this manually for the installer
(it's already added for the installed system).

Wireless MacBook Pro 9,2 Ubuntu 12.10:
apt-get install firmware-linux-nonfree
It may also require linux-headers-generic.

https://help.ubuntu.com/community/MacBook
(e.g. https://help.ubuntu.com/community/MacBookPro6-2/Lucid)
Has instructions for adding a repository and nvidia/pommed packages.

Fn key fix (F1-F12 without Fn) method 1 {
In /etc/pommed.conf set fnmode = 2
}

Fn key fix (to get F1-F12 without Fn) method 2 {
https://help.ubuntu.com/community/AppleKeyboard
1. edit or create /etc/modprobe.d/hid_apple.conf
2. add this line: ‘options hid_apple fnmode=2’
3. save and run ‘sudo update-initramfs -u’
4. reboot
}

― notes:

gsettings set org.gnome.settings-daemon.peripherals.touchpad disable-while-typing true
gsettings set org.gnome.settings-daemon.peripherals.touchpad scroll-method "'two-finger-scrolling'"

# 113 / 96 = 1.177... but the UI will set it to one decimal
# next time you use gnome-tweak-tool; just do it now.
gsettings set org.gnome.desktop.interface text-scaling-factor 1.2
]


Apple Debian GRUB [
In Sep 2013 neither Debian stable (wheezy) nor testing (jessie) install the
bootloder. The workaround below is tested with Debian Jessie & Ubuntu 13.04.

Install Debian

Boot into Ubuntu
If the partition is /dev/sdc1 and you mount it under /mnt/path:
grub-install --force --boot-directory=/mnt/path/boot /dev/sdc1

Start the Debian CD in rescue mode
update-grub
]


phpsh [
http://www.phpsh.org/

git clone git://github.com/facebook/phpsh.git
mkdir -p ~/.phpsh
cp phpsh/rc.example.php ~/.phpsh/rc.php

Edit ~/.phpsh/rc.php replace 'etc/phpsh/rc.php' with '/path/to/repo/src/rc.php'

Run /path/to/repo/src/phpsh
]


Split FLAC EAC tracks [
http://nxadm.wordpress.com/2009/02/09/split-one-flac-cue-file-into-separate-tracks/

? cuetools shntool

Split the album flac file into separate tracks:
$ cuebreakpoints sample.cue | shnsplit -o flac sample.flac

Copy the flac tags (if present):
$ cuetag sample.cue split-track*.flac

In case the cue file is not a separate file, but included in the flac file itself do this as the first step:
$ metaflac --show-tag=CUESHEET sample.flac | grep -v ^CUESHEET > sample.cue
(NB: The regular syntax is “metaflac –export-cuesheet-to=sample.cue sample.flac“, however often the cue file in embedded in a tag instead of the cuesheet block).
]


HP printer [
? hplip
The package should be already installed.
http://hplipopensource.com
http://hplipopensource.com/hplip-web/tech_docs/man_pages/index.html
hp-clean – clean cartridges
hp-levels – show ink levels
]


Inspect RAM Memory Type and Amount [
The commands might incorrectly report the DDR* type, but you can look up the
model number/code.

sudo dmidecode --type 16,17
sudo lshw -C memory
]


-- Ubuntu Studio


Network [
https://help.ubuntu.com/community/UbuntuStudioNetworkSetup

@studio@ network-manager-gnome

Comment-out lines with eth0 in /etc/network/interfaces, effectively getting:
auto lo
iface lo inet loopback

This will probably happen upon reboot so you don't need to do it manually:
sudo service network-manager restart
]


Volume control icon in tray [
Start gnome-volume-control-applet at login
]


-- configurations


VirtualBox [
http://www.virtualbox.org/wiki/Linux_Downloads

Shared folders (with specific owner):
mount -t vboxsf -o uid=1000,gid=1000 sharename /path

Drag windows with Alt key in guest: disable Alt-drag in host (e.g. use Super):
gconftool-2 --set /apps/metacity/general/mouse_button_modifier \
	--type string '<Super>'

NAT Port Forwarding:
http://www.virtualbox.org/manual/ch06.html#natforward

VBoxManage setextradata "Linux Guest"
      "VBoxInternal/Devices/pcnet/0/LUN#0/Config/guestssh/Protocol" TCP
VBoxManage setextradata "Linux Guest"
      "VBoxInternal/Devices/pcnet/0/LUN#0/Config/guestssh/GuestPort" 22
VBoxManage setextradata "Linux Guest"
      "VBoxInternal/Devices/pcnet/0/LUN#0/Config/guestssh/HostPort" 2222
]


VMWare Player [
Download and install.
Service runs at startup: /etc/rc[235].d/vmware -> /etc/init.d/vmware

To disable automatic startup:
# update-rc.d -f vmware remove

To re-enable:
# update-rc.d vmware start 19 2 3 5 . stop 08 2 3 5 .

To manually start:
# /etc/init.d/vmware start

Downloading VMWare Tools from the GUI puts .iso files in
/usr/lib/vmware/isoimages

To remove them:
# vmware-installer -t
# vmware-installer --uninstall-component vmware-tools-windows

If vmplayer-daemon uses up the CPU:
Uncheck all auto-update, auto-download, submit statistics
# cd /usr/lib/vmware/bin
# mv vmplayer-daemon vmplayer-daemon1
]


MySQL [
@headless@ libaio1

http://dev.mysql.com/doc/refman/5.5/en/installing-binary.html
http://www.bluecrownsoftware.com/article/271/Installing-MySQL-without-Root-Access-on-Linux

http://dev.mysql.com/doc/refman/5.5/en/option-files.html
If you have some of the standard dirs or config files present,
e.g. because you installed python-mysqldb,
most programs (including one called by the install script) will read them.
--no-defaults should disable reading any option files.
--defaults-file=/path/to/my-config-file should force only that file

$ ./scripts/mysql_install_db --no-defaults --basedir=. --datadir=./data

1. With config file:
-------------------

-------- /path/to/mysql/my-config-file --------
[client]
socket		= /path/to/mysql/data/mysql.sock
#user		= root

[mysqld]
socket		= mysql.sock
pid-file	= mysql.pid
log-error	= mysql.err
basedir		= /path/to/mysql/
datadir		= /path/to/mysql/data/
-------- /path/to/mysql/my-config-file --------

START: ./bin/mysqld --defaults-file=/path/to/mysql/my-config-file
STOP: ./bin/mysqladmin --defaults-file=/path/to/mysql/my-config-file --user=root shutdown
CONNECT: ./bin/mysql --defaults-file=/path/to/mysql/my-config-file

2. No config file:
-----------------
START: ./bin/mysqld --no-defaults --basedir=. --datadir=./data --log-error=mysql.err --pid-file=./mysql.pid --socket=mysql.sock
STOP: ./bin/mysqladmin --no-defaults --socket=./data/mysql.sock --user=root shutdown
CONNECT: ./bin/mysql --no-defaults --socket=./data/mysql.sock

§ Secure initial accounts
http://dev.mysql.com/doc/refman/5.5/en/default-privileges.html
– Remove anonymous accounts:
method 1 (doesn't seem to remove the 'host_name' row from mysql.user):
	DROP USER ''@'localhost';
	DROP USER ''@'host_name';
method 2:
	DELETE FROM mysql.user where user='';
	FLUSH PRIVILEGES;
– Assign root account passwords:
UPDATE mysql.user SET Password = PASSWORD('newpwd') WHERE User = 'root';
FLUSH PRIVILEGES;

§ Add user
http://dev.mysql.com/doc/refman/5.5/en/adding-users.html
CREATE USER 'custom'@'localhost' IDENTIFIED BY 'newpwd';
GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    ON somedb.*
    TO 'custom'@'localhost';

GRANT FILE
    ON *.*
    TO 'custom'@'localhost';

§ Delete input history
rm ~/.mysql_history
]


GlassFish [
asadmin start-domain --verbose
asadmin stop-domain

asadmin start-database
asadmin stop-database

asadmin deploy full-path-to-war-file
asadmin list-components
asadmin undeploy context-root
]


Apache & PHP [
@headless@ libxml2-dev libapr1-dev libaprutil1-dev

Apache install:
./configure --enable-so --prefix=/programs/apache
make
make install

PHP install:
./configure --prefix=/programs/apache/php --with-apxs2=/programs/apache/bin/apxs --with-config-file-path=/programs/apache/php
make
make install

cp php.ini-development /programs/apache/php/php.ini

Make sure this line has been added to /programs/apache/conf/httpd.conf:
LoadModule php5_module        modules/libphp5.so

Add this:
<FilesMatch \.php$>
    SetHandler application/x-httpd-php
</FilesMatch>

Add index.php to:
<IfModule dir_module>
    DirectoryIndex index.html index.php
</IfModule>
]


Phabricator [
?phabricator? libssl-dev libcurl4-openssl-dev libpng-dev

Run a cron job to: rm -f /var/tmp/phd/logs/daemons.log

§ Arcanist
You need php, arcanist and libphutil on your dev machine.
Add arcanist/bin to your PATH.
Git commit template: git config commit.template arcanist/resources/git/commit-template.txt
Bash completion: source arcanist/resources/shell/bash-completion
‘arc install-certificate’ stores your login tokens in ~/.arcrc

-------- project_root/.arcconfig --------
{
  "project_id" : "some_project_name",
  "conduit_uri" : "https://phabricator.example.com/"
}
-------- project_root/.arcconfig --------
]
